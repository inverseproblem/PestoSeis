.. role:: raw-math(raw)
    :format: latex html
.. _seismicwaves2d_guide:


*******************************************************
Seismic wave propagation -- using ``seismicwaves2d``
*******************************************************

A general form of the elastic wave equation can be derived from the equation of motion and includes momentum and constitutive relationships

.. math::

   \begin{eqnarray}
      \rho\frac{\partial^2 u_i}{\partial t^2}&=\frac{\partial(\sigma_{ij}+M_{ij})}{\partial x_i}+f_i, \\
      \sigma_{ij}&=\lambda\epsilon_{kk}\delta_{ij}+2\mu\epsilon{ij}, \\
      \epsilon_{kl}&=\frac{1}{2}\big(\frac{\partial u_l}{\partial x_k}+\frac{\partial u_k}{\partial x_l}\big),
   \end{eqnarray}
where :math:`u` is the displacement, :math:`\sigma` the stress tensor, :math:`M` the moment tensor :math:`\epsilon` the strain field, :math:`\lambda` and :math:`\mu` the Lame parameters, :math:`f` external forces, :math:`\delta` the Kronecker delta and :math:`i,j,k,l=1,2,3` .

From this relationships, some simplified expressions for specific cases can be derived and in the following we will see the derivation of the acoustic wave equation and the elastic wave equation.

=============================================
Acoustic wave equation in 2D
=============================================

We model acoustic wave propagation through a medium by relating the time and space dependent pressure wavefield :math:`p(\mathbf{x},t)` to some external force :math:`f(\mathbf{x},t)` via the constant density acoustic wave equation. Therefore, we assume a constant density and a vanishing :math:`\mu` and obtain

.. math:: 

   -\frac{1}{c(\mathbf{x})^2}\frac{\partial}{\partial t^2}p(\mathbf{x},t)+\nabla^2 p(\mathbf{x},t)=f(\mathbf{x},t). 

Here, the properties of the medium are parametrized in terms of velocity :math:`c(\mathbf{x},t)`. In 2D, :math:`\mathbf{x}=[x,y]^{\text{T}}` and the spatial derivatives are given by :math:`\nabla=\partial_x(\cdot)+\partial_y(\cdot)`. The acoustic wave equation explicitly shows the relationship between the velocity structure of the medium :math:`[c(\mathbf{x},t)]` and the pressure wavefield :math:`p(\mathbf{x},t)` generated by crompressional waves. Hence it describes the forward problem of simulating the propagation of acoustic waves in a medium, hence solving this equation means that we are interested in obtaining the pressure wavefield given a specific velocity model.

=============================================
Elastic wave equation in 2D
=============================================

The elastic wave equation describes the propagation of waves in an isotropic homogeneous elastic medium. Generally we are interested in obtaining the velocity vector :math:`\mathbf{v}`, consisting of the component of the velocity in each spatial direction. Noting that a component of the velocity vector is given by :math:`v_i=\frac{\partial u_i}{\partial t}` and inserting this into the elastic wave equation, one obtains the velocity-stress formulation for an isotropic medium as

.. math::

   \begin{eqnarray}
      \rho\frac{\partial v_i}{\partial t}&=\frac{\partial(\sigma_{ij}+M_{ij})}{\partial x_j}+f_i, \\
      \frac{\partial \sigma_{ij}}{\partial t}&=\lambda\frac{\partial \epsilon_{kk}}{\partial t}\delta_{ij}+2\mu\frac{\partial\epsilon_{ij}}{\partial t}, \\
      \frac{\partial \epsilon_{ij}}{\partial t}&=\frac{1}{2}\big(\frac{\partial v_j}{\partial x_i}+\frac{\partial v_i}{\partial x_j}\big).
   \end{eqnarray}

Note that reformulating the elastic wave equation in terms of velocity instead of displacement reduces the 2nd order derivative with respect to time to a 1st order derivative. 
  



=============================================
API ``seismicwaves2d``, list of functions
=============================================

.. automodule:: pestoseis.seismicwaves2d
   :members:
   :imported-members:  
..   :undoc-members:
